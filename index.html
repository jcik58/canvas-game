<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Canvas Game Starter</title>
  <style>
    body { margin: 0; background:#111; display:grid; place-items:center; height:100vh; }
    canvas { background:#1b1b1b; border:1px solid #333; }
  </style>
</head>
<body>
<canvas id="c" width="640" height="360"></canvas>
<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

const keys = new Set();
addEventListener("keydown", e => keys.add(e.key));
addEventListener("keyup", e => keys.delete(e.key));

const player = { x: 80, y: 80, w: 24, h: 24, speed: 180 }; // px/sec

let last = performance.now();

function update(dt){
  let vx = 0, vy = 0;
  if (keys.has("ArrowLeft"))  vx -= 1;
  if (keys.has("ArrowRight")) vx += 1;
  if (keys.has("ArrowUp"))    vy -= 1;
  if (keys.has("ArrowDown"))  vy += 1;

  // 斜め移動の速度補正
  if (vx && vy) { const inv = 1/Math.sqrt(2); vx *= inv; vy *= inv; }

  player.x += vx * player.speed * dt;
  player.y += vy * player.speed * dt;

  // 画面外に出ない
  player.x = Math.max(0, Math.min(canvas.width  - player.w, player.x));
  player.y = Math.max(0, Math.min(canvas.height - player.h, player.y));
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // プレイヤー
  ctx.fillStyle = "#4cc9f0";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // UI
  ctx.fillStyle = "#ddd";
  ctx.font = "14px system-ui";
  ctx.fillText("Arrow keys to move", 12, 22);
}

function loop(now){
  const dt = (now - last) / 1000; // 秒
  last = now;

  update(dt);
  draw();

  requestAnimationFrame(loop);
}
requestAnimationFrame(loop);
</script>
</body>
</html>
